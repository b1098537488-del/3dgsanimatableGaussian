defaults:
  - _self_
  - dataset: peoplesnapshot/male-3-casual
  - deformer: smpl_model
  - non-rigid: hashgrid
  
hydra:
  job:
    chdir: true
  run:
    dir: "outputs/${dataset.name}-improved-loss"  # 使用改进版输出目录

num_workers: 1
max_sh_degree: 3
max_freq: 6
use_point_color: False
use_point_displacement: False
enable_ambient_occlusion: True

# 保守优化版损失权重配置（渐进式调整）
lambda_dssim: 0.18       # SSIM损失权重，轻微降低
lambda_lpips: 0.08       # 感知损失权重，降低到保守值
lambda_edge: 0.03        # 边缘损失权重，降低到保守值
lambda_gradient: 0.015   # 梯度损失权重，降低到保守值

# 非刚性正则化损失权重（保守设置，与hashgrid.yaml保持一致）
lambda_nr_xyz: 0.0005    # 位移正则化权重，降低约束强度
lambda_nr_scale: 0.00005 # 尺度正则化权重，降低约束强度
lambda_nr_rot: 0.00005   # 旋转正则化权重，降低约束强度

# 原版配置（已注释，保留备用）
# lambda_dssim: 0.15
# lambda_nr_xyz: 0.003     # 位移正则化权重（降低40%）
# lambda_nr_scale: 0.0003  # 尺度正则化权重（降低40%）
# lambda_nr_rot: 0.0003    # 旋转正则化权重（降低40%）

training_args:
  # 保守优化学习率配置
  weights_lr: 0.00012      # 高斯权重学习率，轻微提升
  joint_lr: 0.0011         # 关节学习率，轻微增加
  opacity_lr: 0.022        # 透明度学习率，轻微提升
  scaling_lr: 0.0055       # 缩放学习率，轻微提升
  rotation_lr: 0.0011      # 旋转学习率，轻微提升
  ao_lr: 0.0055            # 环境光遮蔽学习率
  displacement_lr: 0.0055  # 位移学习率，轻微提升
  displacement_encoder_lr: 0.0011  # 位移编码器学习率
  shs_lr: 0.0028           # 球谐函数学习率，轻微提升
  sh_encoder_lr: 0.0011    # 球谐编码器学习率
  non_rigid_lr: 0.0011     # HashGrid非刚性模块学习率

trainer_args:
  max_epochs: 15
  check_val_every_n_epoch: 3

# 指定使用改进版模型（默认启用）
model_class: animatableGaussian.model.nerf_model.NeRFModel

# 原版模型配置（已注释，保留备用）
# model_class: animatableGaussian.model.nerf_model.OriginalNeRFModel