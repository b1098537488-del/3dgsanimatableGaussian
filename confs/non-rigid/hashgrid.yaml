# @package _global_

non_rigid_name: hashgrid

model:
  deformer:
    non_rigid:
      name: hashgrid
      scale_offset: logit
      rot_offset: mult

      delay: 1000              # 增加延迟，让基础模型先稳定

      feature_dim: 32          # 降低特征维度
      latent_dim: 32
      pose_encoder:
        num_joints: 24
        rel_joints: false
        dim_per_joint: 6
        out_dim: 0

      hashgrid:
        n_levels: 12             # 减少层数
        n_features_per_level: 2
        log2_hashmap_size: 16    # 回到原始大小
        base_resolution: 16
        per_level_scale: 1.447269237440378
        max_resolution: 2048     # 降低最大分辨率

      mlp:
        n_neurons: 128           # 回到原始神经元数
        n_hidden_layers: 2       # 减少到2层
        skip_in: []              # 移除跳跃连接
        cond_in: [0]             # 只在第0层添加条件
        multires: 0              # 关闭位置编码
        last_layer_init: true

opt:
  lambda_nr_xyz: 0.0002
  lambda_nr_scale: 0.00002
  lambda_nr_rot: 0.00002
  non_rigid_lr: 0.0003
  nr_latent_lr: 0.0008       # 降低时间潜码学习率