# @package _global_

non_rigid_name: hashgrid

model:
  deformer:
    non_rigid:
      name: hashgrid
      scale_offset: logit
      rot_offset: mult

      delay: 2000  # 减少延迟，更早开始非刚性变形

      feature_dim: 96  # 增加特征维度
      latent_dim: 0
      pose_encoder:
        num_joints: 24
        rel_joints: false
        dim_per_joint: 6
        out_dim: -1

      hashgrid:
        n_levels: 20  # 增加层数
        n_features_per_level: 4  # 增加每层特征数
        log2_hashmap_size: 18  # 增加哈希表大小
        base_resolution: 16
        per_level_scale: 1.3  # 调整缩放因子
        max_resolution: 4096  # 提高最大分辨率

      mlp:
        n_neurons: 256  # 增加神经元数量
        n_hidden_layers: 4  # 增加隐藏层数
        skip_in: [2]  # 添加跳跃连接
        cond_in: [ 0 ]
        multires: 0

        last_layer_init: false

opt:
  lambda_nr_xyz: 0.
  lambda_nr_scale: 0.
  lambda_nr_rot: 0.
  non_rigid_lr: 1.5e-3  # 提高学习率
  nr_latent_lr: 1.5e-3